/* ========== THEME ========== */
:root{
  --yellow:#ebbe2d;     /* machine body */
  --accent:#d74824;     /* brand red */
  --black:#000;         /* bezel/border */
  --panel:#0f141b;      /* dark panels */
  --btn:#2a2f39;        /* button bg */
  --text:#111;
}

*{box-sizing:border-box}
html,body{height:100%}
img{max-width:100%;display:block}

/* ========== BASE ========== */
body{
  margin:0;
  background:var(--yellow);
  color:var(--text);
  font:16px/1.4 Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}
.header{display:flex;align-items:center;gap:10px;padding:10px 14px}
.header img{width:24px;height:24px}
.brand{font-weight:900;letter-spacing:.08em}

/* ========== MACHINE FRAME ========== */
.machine{
  width:min(1200px,95vw);
  margin:20px auto 40px;
  display:grid;
  grid-template-columns: 1.55fr .65fr .5fr; /* left / middle / right */
  gap:16px;
  background:var(--yellow);
  padding:18px;
  border-radius:18px;
  box-shadow:
    inset 0 0 0 3px var(--black),
    0 12px 40px rgba(0,0,0,.25);
  position:relative;
}
/* feet */
.machine::before,.machine::after{
  content:"";
  position:absolute; bottom:-12px;
  width:120px; height:18px; background:#111; border-radius:8px;
}
.machine::before{left:40px}
.machine::after{right:40px}

/* ========== LEFT: DISPLAY CASE (3x3) ========== */
.window{
  background:var(--yellow);
  border:8px solid var(--black);
  border-radius:12px;
  padding:12px;
  display:grid;
  grid-template-rows:auto 1fr;
  gap:12px;
}
.window-header{display:grid;grid-template-columns:auto 1fr;gap:10px;align-items:center}
.window-logo{width:64px;height:64px}
.window h1{margin:0;color:#fff;font-weight:900;line-height:.9;text-shadow:0 2px 0 rgba(0,0,0,.35)}

.grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:12px}
.card{
  background:#fff;
  border-radius:14px;
  overflow:hidden;
  display:grid;
  grid-template-rows:150px auto;
  box-shadow:0 1px 0 rgba(0,0,0,.08);
}
.card .img{background-size:cover;background-position:center}
.card .meta{padding:10px}
.card .title{font-weight:900}
.card .series{font-size:12px;color:#667085;margin-top:2px}
.card .row{display:flex;justify-content:space-between;margin-top:6px}
.card .price{font-weight:900}

/* ========== MIDDLE: CHOICE + FLAP ========== */
.console{
  display:grid;
  grid-template-rows:auto auto auto auto; /* screen, controls, hint, flap */
  gap:12px;
}

/* shared screen style (choice) */
.screen{
  height:200px;
  background:#000;
  border:8px solid var(--black);
  border-radius:10px;
  background-size:cover;
  background-position:center;
  position:relative;
  display:block;
}
#choice-screen{ cursor:pointer; transform: translateY(12px); }
.screen .label{
  position:absolute; left:10px; right:10px; bottom:10px;
  color:#fff; font-weight:900; text-shadow:0 2px 6px rgba(0,0,0,.6);
}

/* arrows under choice screen */
.screen-controls{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.screen-controls button{
  margin-top:5px;
  background:var(--btn); color:#fff;
  border:0; border-radius:10px; padding:10px 0;
  font-weight:800; cursor:pointer;
}

/* copy/smaller note */
.hint{margin:0 2px; font-size:12px; color:#3b2b00}

/* ========== CLAW-MACHINE DOOR FLAP ========== */
.flap-slot{
  height:150px;
  border:8px solid var(--black);
  border-radius:12px;
  background:#262626;
  display:grid;
  place-items:center;
  perspective:900px;
  overflow:hidden;
}
.flap{
  appearance:none;
  border:4px solid #000;
  border-radius:14px;
  width:92%;
  height:92%;
  background:
    radial-gradient(140% 120% at 20% 10%, rgba(255,255,255,.55), rgba(255,255,255,0) 35%),
    linear-gradient(180deg, #d8bf4c 0%, #caa93a 50%, #b8932e 100%);
  box-shadow:
    inset 0 0 0 2px rgba(0,0,0,.65),
    0 12px 18px rgba(0,0,0,.35);
  color:#111;
  font-weight:900;
  text-transform:uppercase;
  letter-spacing:.02em;
  transform-origin:top center;
  transform:translateY(-2px) rotateX(-4deg);
  transition:transform .18s ease, box-shadow .18s ease;
  cursor:pointer;
  position:relative;
}
.flap::after{
  /* lower dark portion hinting the chute interior */
  content:"";
  position:absolute; left:0; right:0; bottom:-18%;
  height:40%;
  background:
    linear-gradient(0deg, #3c3131 0%, #221e1e 45%, transparent 100%);
  border-bottom-left-radius:12px;
  border-bottom-right-radius:12px;
  pointer-events:none;
}
.flap:hover{ transform:translateY(-4px) rotateX(-10deg); }
.flap:active{ transform:translateY(-6px) rotateX(-16deg); }
.flap-text{
  display:block;
  text-align:center;
  color:#111;
  text-shadow:0 1px 0 rgba(255,255,255,.35);
  font-weight:900;
  line-height:1.05;
}

/* Quick peek animation when a prize lands */
.flap.peek { animation: flapPeek .9s ease-in-out; }
@keyframes flapPeek{
  0%   { transform:translateY(-2px) rotateX(-4deg); }
  30%  { transform:translateY(-6px) rotateX(-18deg); }
  60%  { transform:translateY(-3px) rotateX(-8deg); }
  100% { transform:translateY(-2px) rotateX(-4deg); }
}

/* ========== RIGHT: PRIZE CASE (4 shelves) ========== */
.prize-case{
  background:var(--yellow);
  border:8px solid var(--black);
  border-radius:12px;
  padding:10px;
  display:grid;
  grid-template-rows:repeat(4,1fr);
  gap:10px;
}
.shelf{
  background:var(--panel);
  border-radius:8px;
  display:grid;
  place-items:center;
}
.shelf img{max-width:90%;max-height:90%;object-fit:contain}

/* ========== DRAWERS ========== */
.drawer{position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.6); z-index:50}
.drawer.open{display:grid}
.sheet{
  width:min(720px,92vw);
  background:#0f141b; color:#fff;
  border-radius:16px; padding:24px; position:relative;
}
.cart-sheet{ width:min(820px,95vw); }
.close{position:absolute; right:16px; top:12px; background:transparent; border:0; color:#fff; font-size:22px; cursor:pointer}

/* cart content */
.cart-list{list-style:none; margin:0; padding:0; display:grid; gap:12px; max-height:min(52vh,520px); overflow:auto}
.cart-item{
  display:grid;
  grid-template-columns:72px 1fr auto;
  gap:12px; align-items:center;
  background:#0b1118; border:1px solid #283041; border-radius:12px; padding:10px;
}
.cart-item img{width:72px; height:72px; object-fit:cover; border-radius:8px}
.cart-name{font-weight:800}
.cart-series{font-size:12px; opacity:.7}
.cart-price{font-weight:900}
.cart-qty{
  display:flex; align-items:center; gap:8px;
  background:#101722; border-radius:8px; padding:6px 8px;
}
.cart-qty button{
  width:28px; height:28px; border-radius:8px;
  background:#0f1420; color:#e7eefc; border:0; cursor:pointer;
}
.cart-qty .qty{min-width:28px; text-align:center; font-weight:900}

.cart-footer{
  display:flex; align-items:center; justify-content:space-between;
  margin-top:14px;
}
.btn{
  border:0; border-radius:10px; padding:10px 14px; font-weight:900; cursor:pointer;
}
.btn.primary{ background:var(--accent); color:#fff; }
.btn.ghost{ background:transparent; color:#fff; border:1px solid #3a465d; }

/* ========== CHECKOUT FORM ========== */
.form .row{display:grid; grid-template-columns:1fr 1fr; gap:12px}
.form input,.form textarea,.form select{
  width:100%; padding:10px; border-radius:10px;
  border:1px solid #283041; background:#0a0f16; color:#e7eefc;
}
.submit{background:var(--accent); color:#fff; border:0; border-radius:10px; padding:12px; font-weight:900; cursor:pointer; width:100%}

/* ========== FOOTER ========== */
.footer{padding:20px; text-align:center; opacity:.7}

/* ========== FLY ANIMATION GHOST ========== */
.fly-ghost{
  position:fixed;
  z-index:60;
  width:86px; height:86px;
  object-fit:cover;
  border-radius:12px;
  box-shadow:0 10px 24px rgba(0,0,0,.35);
  pointer-events:none;
}

/* ========== SMALL RESPONSIVE NUDGE ========== */
@media (max-width: 980px){
  .machine{grid-template-columns:1fr}
  .console{grid-template-rows:auto auto auto auto}
  .prize-case{grid-template-rows:repeat(4,160px)}
}
