/* ========== THEME ========== */
:root{
  --yellow:#ebbe2d;     /* machine body */
  --accent:#d74824;     /* brand red */
  --black:#000;         /* bezel/border */
  --panel:#0f141b;      /* dark panels */
  --btn:#2a2f39;        /* button bg */
  --text:#111;
}

*{box-sizing:border-box}
html,body{height:100%}
img{max-width:100%;display:block}

/* ========== BASE ========== */
body{
  margin:0;
  background:var(--yellow);
  color:var(--text);
  font:16px/1.4 Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}
.header{display:flex;align-items:center;gap:10px;padding:10px 14px}
.header img{width:24px;height:24px}
.brand{font-weight:900;letter-spacing:.08em}

/* ========== MACHINE FRAME ========== */
.machine{
  width:min(1200px,95vw);
  margin:20px auto 40px;
  display:grid;
  grid-template-columns: 1.55fr .65fr .5fr; /* left / middle / right */
  gap:16px;
  background:var(--yellow);
  padding:18px;
  border-radius:18px;
  box-shadow:
    inset 0 0 0 3px var(--black),
    0 12px 40px rgba(0,0,0,.25);
  position:relative;
}
/* feet */
.machine::before,.machine::after{
  content:"";
  position:absolute; bottom:-12px;
  width:120px; height:18px; background:#111; border-radius:8px;
}
.machine::before{left:40px}
.machine::after{right:40px}

/* ========== LEFT: DISPLAY CASE (3x3) ========== */
.window{
  background:var(--yellow);
  border:8px solid var(--black);
  border-radius:12px;
  padding:12px;
  display:grid;
  grid-template-rows:auto 1fr;
  gap:12px;
}
.window-header{display:grid;grid-template-columns:auto 1fr;gap:10px;align-items:center}
.window-logo{width:64px;height:64px}
.window h1{margin:0;color:#fff;font-weight:900;line-height:.9;text-shadow:0 2px 0 rgba(0,0,0,.35)}

.grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:12px}
.card{
  background:#fff;
  border-radius:14px;
  overflow:hidden;
  display:grid;
  grid-template-rows:150px auto;
  box-shadow:0 1px 0 rgba(0,0,0,.08);
}
.card .img{background-size:cover;background-position:center}
.card .meta{padding:10px}
.card .title{font-weight:900}
.card .series{font-size:12px;color:#667085;margin-top:2px}
.card .row{display:flex;justify-content:space-between;margin-top:6px}
.card .price{font-weight:900}

/* ========== MIDDLE: CHOICE + FLAP ========== */
.console{
  display:grid;
  /* screen, controls, hint, coin, flap */
  grid-template-rows:auto auto auto auto auto;
  gap:12px;
}

/* shared screen style (choice) */
.screen{
  height:200px;
  background:#000;
  border:8px solid var(--black);
  border-radius:10px;
  background-size:cover;
  background-position:center;
  position:relative;
  display:block;
}
#choice-screen{
  cursor:pointer;
  transform: translateY(12px); /* nudge down without moving arrows */
}
.screen .label{
  position:absolute; left:10px; right:10px; bottom:10px;
  color:#fff; font-weight:900; text-shadow:0 2px 6px rgba(0,0,0,.6);
}

/* arrows under choice screen */
.screen-controls{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.screen-controls button{
  margin-top:5px;
  background:var(--btn); color:#fff;
  border:0; border-radius:10px; padding:10px 0;
  font-weight:800; cursor:pointer;
}

/* copy note */
.hint{margin:0 2px; font-size:12px; color:#3b2b00}

/* coin / checkout */
.coin{
  height:48px;
  border:8px solid var(--black);
  border-radius:12px;
  background:#222; color:#ffd86a;
  font-weight:900; font-size:22px;
  cursor:pointer;
}

/* ===== Flap cart (trigger) ===== */
.cart-title{font-weight:900;margin:0;line-height:1}
.cart-flap{
  background:var(--yellow);
  border:8px solid var(--black);
  border-radius:12px;
  padding:10px;
  display:grid;
  grid-template-rows:auto 1fr;
  gap:6px;
  align-self:start;
}
.flap-window{
  background:var(--yellow);
  border:8px solid var(--black);
  border-radius:10px;
  height:200px;                 /* match screens */
  position:relative;
  perspective:900px;
  display:grid; place-items:center;
  overflow:hidden;
}
.flap-door{
  position:absolute; inset:12px;
  background:#0b0b0b;
  border-radius:8px;
  transform-origin:top;
  transform:rotateX(0deg);
  transition:transform .18s ease;
  box-shadow: inset 0 -6px 12px rgba(0,0,0,.6);
}
.cart-flap:hover .flap-door{ transform:rotateX(-10deg); }
.cart-flap:active .flap-door,
.cart-flap.open .flap-door{ transform:rotateX(-70deg); }

.flap-total{
  position:absolute; bottom:10px; left:0; right:0;
  text-align:center; font-weight:900; color:#fff;
  z-index:1;
}

/* ===== Slide-out cart panel ===== */
.cart-panel{
  position:fixed; right:-420px; top:0;
  width:360px; height:100dvh;
  background:#0f141b; color:#fff;
  box-shadow:-8px 0 24px rgba(0,0,0,.35);
  transition:right .28s ease;
  z-index:60; display:grid;
  grid-template-rows:auto 1fr auto;
}
.cart-panel.open{ right:0; }
.cp-head{display:flex; justify-content:space-between; align-items:center; padding:14px 16px; border-bottom:1px solid #223}
.cp-head h3{margin:0; font-weight:900}
.close-cart{background:transparent; border:0; color:#fff; font-size:22px; cursor:pointer}
.cart-items{padding:10px 12px; overflow:auto}
.cp-foot{padding:14px 16px; border-top:1px solid #223; display:flex; justify-content:space-between; align-items:center}
.panel-total{font-weight:900}

/* line items */
.ci{display:grid; grid-template-columns:60px 1fr auto; gap:10px; align-items:center; padding:10px 0; border-bottom:1px dashed #293342}
.ci img{width:60px;height:60px;object-fit:cover;border-radius:8px}
.ci-title{font-weight:800}
.ci-price{opacity:.8;font-size:14px}
.ci-qty{display:flex; align-items:center; gap:8px}
.ci-qty button{width:28px;height:28px;border-radius:8px;border:0;background:#1a2230;color:#e7eefc;cursor:pointer}
.ci-empty{opacity:.8; text-align:center; padding:40px 0}

/* ========== RIGHT: PRIZE CASE (4 shelves) ========== */
.prize-case{
  background:var(--yellow);
  border:8px solid var(--black);
  border-radius:12px;
  padding:10px;
  display:grid;
  grid-template-rows:repeat(4,1fr);
  gap:10px;
}
.shelf{
  background:var(--panel);
  border-radius:8px;
  display:grid;
  place-items:center;
}
.shelf img{max-width:90%;max-height:90%;object-fit:contain}

/* ========== DRAWER / FORM ========== */
.drawer{position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.6)}
.drawer.open{display:grid}
.sheet{
  width:min(720px,92vw);
  background:#0f141b; color:#fff;
  border-radius:16px; padding:24px; position:relative;
}
.close{position:absolute; right:16px; top:12px; background:transparent; border:0; color:#fff; font-size:22px; cursor:pointer}
.form .row{display:grid; grid-template-columns:1fr 1fr; gap:12px}
.form input,.form textarea,.form select{
  width:100%; padding:10px; border-radius:10px;
  border:1px solid #283041; background:#0a0f16; color:#e7eefc;
}
.submit{background:var(--accent); color:#fff; border:0; border-radius:10px; padding:12px; font-weight:900; cursor:pointer; width:100%}

/* ========== FOOTER ========== */
.footer{padding:20px; text-align:center; opacity:.7}

/* ========== SMALL RESPONSIVE NUDGE ========== */
@media (max-width: 980px){
  .machine{grid-template-columns:1fr}
  .console{grid-template-rows:auto auto auto auto auto}
  .prize-case{grid-template-rows:repeat(4,160px)}
}
